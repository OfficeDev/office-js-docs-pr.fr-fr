---
title: Demande d’autorisations d’utilisation de l’API dans des compléments
description: Découvrez les différents niveaux d’autorisation à déclarer dans le manifeste d’un application de contenu ou du volet Des tâches pour spécifier le niveau d’accès à l’API JavaScript.
ms.date: 03/19/2019
localization_priority: Normal
ms.openlocfilehash: bdc23d1d8d5ff044a14306a868567864865c012d
ms.sourcegitcommit: ee9e92a968e4ad23f1e371f00d4888e4203ab772
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/23/2021
ms.locfileid: "53075970"
---
# <a name="requesting-permissions-for-api-use-in-add-ins"></a>Demande d’autorisations d’utilisation de l’API dans des compléments

Cet article décrit les différents niveaux d’autorisation que vous pouvez déclarer dans le manifeste de votre complément de contenu ou du volet Office afin de spécifier le niveau d’accès de l’API JavaScript requis pour les fonctionnalités de votre complément. 

## <a name="permissions-model"></a>Modèles d’autorisation

Le modèle d’autorisations d’accès de l’API JavaScript à cinq niveaux fournit les bases de confidentialité et de sécurité pour les utilisateurs de vos compléments de contenu et du volet Office. La figure 1 montre les cinq niveaux d’autorisations de l’API que vous pouvez déclarer dans le manifeste de votre complément.

*Figure 1. Modèle d’autorisations à cinq niveaux pour les compléments de contenu et du volet Office*

![Niveaux d’autorisations pour les applications de volet de tâches.](../images/office15-app-sdk-task-pane-app-permission.png)

Ces autorisations spécifient le sous-ensemble de l’API auquel votre complément de contenu ou du volet Office est autorisé à accéder par l’environnement d’exécution lorsqu’un utilisateur insère, puis active (approuve) votre complément. Pour déclarer le niveau d’autorisation nécessaire à votre complément de contenu ou du volet Office, indiquez l’une des valeurs de texte d’autorisation dans l’élément [Permissions](../reference/manifest/permissions.md) du manifeste de votre complément. L’exemple suivant demande l’autorisation **WriteDocument**, laquelle n’autorise que les méthodes pouvant écrire dans le document (et non le lire).

```XML
<Permissions>WriteDocument</Permissions>
```

Il est recommandé de toujours demander les autorisations sur la base du principe d’ _autorisation minimum_. En d’autres termes, vous devez demander l’autorisation d’accéder uniquement au sous-ensemble de l’API nécessaire au bon fonctionnement de votre complément. Par exemple, si votre complément est conçu pour uniquement lire des données dans le document d’un utilisateur, vous ne devez demander que l’autorisation **ReadDocument**.

Le tableau suivant décrit le sous-ensemble de l’API JavaScript activé pour chaque niveau d’autorisation.

|**Autorisation**|**Sous-ensemble de l’API activé**|
|:-----|:-----|
|**Restricted**|Les méthodes de l’objet [Settings](/javascript/api/office/office.settings) et la méthode [Document.getActiveViewAsync](/javascript/api/office/office.document#getactiveviewasync-options--callback-).Niveau d’autorisation minimal pouvant être demandé par un complément de contenu ou du volet Office.|
|**ReadDocument**|En plus de l’API autorisée par l’autorisation **Restreint,** ajoute l’accès aux membres de l’API nécessaires pour lire le document et gérer les liaisons. Cela inclut l’utilisation des :<br/><ul><li>La méthode <a href="/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-" target="_blank">Document.getSelectedDataAsync</a> pour obtenir les données texte, HTML (Word uniquement) ou tabulaires sélectionnées, mais pas le code sous-jacent Open Office XML (OOXML) contenant toutes les données du document.</p></li><li><p>La méthode <a href="/javascript/api/office/office.document#getfileasync-filetype--options--callback-" target="_blank">Document.getFileAsync</a> pour obtenir la totalité du texte du document, mais pas la copie binaire OOXML sous-jacente du document.</p></li><li><p>La méthode <a href="/javascript/api/office/office.binding#getdataasync-options--callback-" target="_blank">Binding.getDataAsync</a> pour la lecture des données liées dans le document.</p></li><li><p>Les méthodes <a href="/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-" target="_blank">addFromNamedItemAsync</a>, <a href="/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-" target="_blank">addFromPromptAsync</a> et <a href="/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-" target="_blank">addFromSelectionAsync</a> de l’objet <span class="keyword">Bindings</span> pour la création de liaisons dans le document.</p></li><li><p>Les méthodes <a href="/javascript/api/office/office.bindings#getallasync-options--callback-" target="_blank">getAllAsync</a>, <a href="/javascript/api/office/office.bindings#getbyidasync-id--options--callback-" target="_blank">getByIdAsync</a> et <a href="/javascript/api/office/office.bindings#releasebyidasync-id--options--callback-" target="_blank">releaseByIdAsync</a> de l’objet <span class="keyword">Bindings</span> pour accéder aux liaisons du document et les supprimer.</p></li><li><p>La méthode <a href="/javascript/api/office/office.document#getfilepropertiesasync-options--callback-" target="_blank">Document.getFilePropertiesAsync</a> pour accéder aux propriétés du fichier de document, comme l’URL du document.</p></li><li><p>La méthode <a href="/javascript/api/office/office.document#gotobyidasync-id--gototype--options--callback-" target="_blank">Document.goToByIdAsync</a> pour accéder aux objets et aux emplacements nommés dans le document.</p></li><li><p>Pour les compléments du volet Office de Project, toutes les méthodes d’obtention (get) de l’objet <a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a>. </p></li></ul>|
|**ReadAllDocument**|Outre l’API autorisée par les autorisations **Restricted** et **ReadDocument,** permet l’accès supplémentaire suivant aux données de document :<br/><ul><li><p>Les méthodes <span class="keyword">Document.getSelectedDataAsync</span> et <span class="keyword">Document.getFileAsync</span> pour accéder au code OOXML sous-jacent du document (qui peut inclure une mise en forme, des liens, des graphiques incorporés, des commentaires, des révisions, etc. en plus du texte).</p></li></ul>|
|**WriteDocument**|En plus de l’API autorisée par **l’autorisation Restreint,** ajoute l’accès aux membres d’API suivants :<br/><ul><li><p>La méthode <a href="/javascript/api/office/office.document#setselecteddataasync-data--options--callback-" target="_blank">Document.setSelectedDataAsync</a> pour écrire dans la sélection de l’utilisateur dans le document.</p></li></ul>|
|**ReadWriteDocument**|En plus de l’API autorisée par les autorisations **Restricted**, **ReadDocument**, **ReadAllDocument** et **WriteDocument,** inclut l’accès à toutes les API restantes pris en charge par les compléments de contenu et du volet Des tâches, y compris les méthodes d’abonnement aux événements. Vous devez déclarer **l’autorisation ReadWriteDocument** pour accéder à ces membres d’API supplémentaires :<br/><ul><li><p>La méthode <a href="/javascript/api/office/office.binding#setdataasync-data--options--callback-" target="_blank">Binding.setDataAsync</a> pour écrire dans des zones liées du document.</p></li><li><p>La méthode <a href="/javascript/api/office/office.tablebinding#addrowsasync-rows--options--callback-" target="_blank">TableBinding.addRowsAsync</a> pour ajouter des lignes dans les tables liées.</p></li><li><p>La méthode <a href="/javascript/api/office/office.tablebinding#addcolumnsasync-tabledata--options--callback-" target="_blank">TableBinding.addColumnsAsync</a> pour ajouter des colonnes dans les tables liées.</p></li><li><p>La méthode <a href="/javascript/api/office/office.tablebinding#deletealldatavaluesasync-options--callback-" target="_blank">TableBinding.deleteAllDataValuesAsync</a> pour supprimer toutes les données d’une table liée.</p></li><li><p>Les méthodes <a href="/javascript/api/office/office.tablebinding#setformatsasync-cellformat--options--callback-" target="_blank">setFormatsAsync</a>, <a href="/javascript/api/office/office.tablebinding#clearformatsasync-options--callback-" target="_blank">clearFormatsAsync</a> et <a href="/javascript/api/office/office.tablebinding#settableoptionsasync-tableoptions--options--callback-" target="_blank">setTableOptionsAsync</a> de l’objet <span class="keyword">TableBinding</span> pour définir la mise en forme et les options des tables liées.</p></li><li><p>Tous les membres des objets <a href="/javascript/api/office/office.customxmlnode" target="_blank">CustomXmlNode</a>, <a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>, <a href="/javascript/api/office/office.customxmlparts" target="_blank">CustomXmlParts</a> et <a href="/javascript/api/office/office.customxmlprefixmappings" target="_blank">CustomXmlPrefixMappings</a>.</p></li><li><p>Toutes les méthodes d’abonnement à des événements prises en charge par les compléments de contenu et du volet Office, en particulier les méthodes <span class="keyword">addHandlerAsync</span> et <span class="keyword">removeHandlerAsync</span> des objets <a href="/javascript/api/office/office.binding" target="_blank">Binding</a>, <a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>, <a href="/javascript/api/office/office.document" target="_blank">Document</a>, <a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a> et <a href="/javascript/api/office/office.document#settings" target="_blank">Settings</a>.</p></li></ul>|

## <a name="see-also"></a>Voir aussi

- [Confidentialité et sécurité pour les compléments Office](../concepts/privacy-and-security.md)
