---
title: Limites pour l’activation et l’utilisation des API dans des compléments Outlook
description: Tenez compte de certaines instructions relatives à l’activation et l’utilisation des API et implémentez vos compléments pour respecter ces limites.
ms.date: 10/31/2019
localization_priority: Normal
ms.openlocfilehash: 15fba6d0be2f638bfa4ffd531da5876a4ccbc876
ms.sourcegitcommit: a3ddfdb8a95477850148c4177e20e56a8673517c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/20/2020
ms.locfileid: "42166185"
---
# <a name="limits-for-activation-and-javascript-api-for-outlook-add-ins"></a>Limites pour l’activation et l’API JavaScript pour les compléments Outlook

Pour offrir une expérience satisfaisante aux utilisateurs de compléments Outlook, il convient de connaître certaines recommandations relatives à l’activation et à l’utilisation de l’API afin d’implémenter vos compléments tout en respectant ces limites. Ces recommandations permettent de s’assurer que le traitement par Exchange Server ou Outlook des règles d’activation ou des appels à l’interface API JavaScript pour Office n’est pas anormalement long pour un complément particulier, ce qui aurait une incidence sur l’expérience globale de l’utilisateur dans Outlook et d’autres compléments. Ces limites s’appliquent à la conception de règles d’activation dans le manifeste du complément, ainsi qu’à l’utilisation de propriétés personnalisées, de paramètres d’itinérance, de destinataires, de demandes et réponses de Services Web Exchange (EWS) et d’appels asynchrones.

> [!NOTE]
> Si votre complément s’exécute sur un client riche Outlook, vous devez également vérifier que le complément s’exécute dans certaines limites d’utilisation des ressources au moment de l’exécution.

## <a name="limits-on-where-add-ins-activate"></a>Limites relatives à l’emplacement d’activation des compléments

Les compléments sont conçus pour être activés uniquement dans la boîte aux lettres principale de l’utilisateur. Les compléments ne sont pas activés dans les boîtes aux lettres partagées, les dossiers des boîtes aux lettres d’autres utilisateurs ouverts avec l’accès délégué, les boîtes aux lettres d’archivage ou les dossiers publics.

## <a name="limits-for-activation-rules"></a>Limites pour les règles d’activation

Suivez les recommandations ci-dessous lors de la création de règles d’activation pour les compléments Outlook :

- Limitez la taille du manifeste à 256 Ko. Vous ne pouvez pas installer le complément Outlook pour une boîte aux lettres Exchange si vous dépassez cette limite.

- Spécifiez jusqu’à quinze règles d’activation pour le complément. Vous ne pouvez pas installer le complément si vous dépassez cette limite.

- Si vous appliquez une règle [ItemHasKnownEntity](../reference/manifest/rule.md#itemhasknownentity-rule) au corps de l’élément sélectionné, attendez-vous à ce qu’un client riche Outlook n’applique la règle qu’au premier mégaoctet du corps et non au reste du corps compris au-delà de cette limite. Votre complément ne sera pas activé s’il existe uniquement des correspondances comprises au-delà du premier mégaoctet du corps. Si ce scénario vous semble probable, redéfinissez vos conditions relatives à l’activation.

- Si vous utilisez des expressions régulières dans les règles **ItemHasKnownEntity** ou [ItemHasRegularExpressionMatch](../reference/manifest/rule.md#itemhasregularexpressionmatch-rule), tenez compte des recommandations et limites suivantes qui s’appliquent généralement à n’importe quel hôte Outlook, et celles décrites dans les tableaux 1, 2 et 3 qui diffèrent en fonction de l’hôte :
   - Spécifiez au maximum cinq expressions régulières dans les règles d’activation d’un complément. Vous ne pouvez pas installer un complément si vous dépassez cette limite.
   - Spécifiez des expressions régulières afin que les résultats que vous prévoyez d’obtenir soient renvoyés par l’appel de la méthode **getRegExMatches** dans les 50 premières correspondances.
   - Peut spécifier des assertions avant dans les expressions régulières, mais pas d’assertions arrière, `(?<=text)`, ni d’assertions arrière négatives `(?<!text)`.

Le tableau 1 répertorie les limites et décrit les différences de prise en charge des expressions régulières entre un client riche Outlook et Outlook sur le Web ou les appareils mobiles. The support is independent of any specific type of device and item body.

**Tableau 1. Différences générales dans la prise en charge des expressions régulières**

|Client riche Outlook|Outlook sur le web ou sur appareils mobiles|
|:-----|:-----|
|Utilise le moteur d’expression régulière C++ fourni dans le cadre de la bibliothèque de modèles standard Visual Studio. Ce moteur est conforme aux normes ECMAScript 5. |Utilise l’évaluation d’expression régulière incluse dans JavaScript ; celle-ci est fournie par le navigateur et prend en charge un sur-ensemble d’ECMAScript 5.|
|En raison des différents moteurs Regex, attendez-vous à ce qu’une expression régulière comprenant une classe de caractères personnalisée basée sur des classes de caractères prédéfinies puisse renvoyer des résultats différents dans un client riche Outlook par rapport à Outlook sur le Web ou aux appareils mobiles.<br/><br/>Par exemple, l’expression régulière `[\s\S]{0,100}` correspond à tout nombre, compris entre 0 et 100, de caractères uniques correspondant à un espace blanc ou à un espace non blanc. Cette expression régulière renvoie des résultats différents dans un client riche Outlook par rapport à Outlook sur le Web et les appareils mobiles.<br/><br/>Comme solution de contournement, vous devez réécrire l’expression régulière de la manière suivante : `(\s\|\S){0,100}`. Cette expression régulière correspond à un nombre, compris entre 0 et 100, d’espace blanc ou d’espace non blanc.<br/><br/>Vous devez tester minutieusement chaque expression régulière sur chaque hôte Outlook et, si une expression régulière renvoie des résultats différents, la réécrire. |Vous devez tester minutieusement chaque expression régulière sur chaque hôte Outlook et, si une expression régulière renvoie des résultats différents, la réécrire.|
|Par défaut, limite l’évaluation de toutes les expressions régulières pour un complément à 1 seconde. Le dépassement de cette limite engendre une réévaluation à 3 reprises au maximum. Au-delà de la limite de réévaluation, un client riche Outlook désactive l’exécution du complément pour la même boîte aux lettres dans n’importe lequel des hôtes Outlook.<br/><br/>Les administrateurs peuvent remplacer ces limites d’évaluation à l’aide des clés de registre **OutlookActivationAlertThreshold** et **OutlookActivationManagerRetryLimit**.|Ne prend pas en charge les mêmes paramètres de surveillance des ressources ou du Registre que dans un client riche Outlook. Toutefois, les compléments avec expressions régulières qui requièrent un temps d’évaluation trop long sur un client riche Outlook sont désactivés pour la même boîte aux lettres sur tous les hôtes Outlook.|

Le tableau 2 répertorie les limites et décrit les différences dans la partie du corps d’élément auquel chaque hôte Outlook applique une expression régulière. Certaines de ces limites dépendent du type d’appareil et de corps d’élément, si l’expression régulière est appliquée sur le corps d’élément.

**Tableau 2. Limites de la taille du corps d’élément évalué**

||Client riche Outlook|Outlook sur les appareils mobiles|Outlook sur le web|
|:-----|:-----|:-----|:-----|
|Facteur de forme|Tout appareil pris en charge|Smartphones Android, iPad ou iPhone|Tout appareil pris en charge autre que les smartphones Android, l’iPad et l’iPhone|
|Corps d’élément en texte brut|Applique le regex sur le premier mégaoctet des données du corps, mais pas sur le reste du corps au-delà de cette limite.|Active le complément uniquement si le corps < 16 000 caractères.|Active le complément uniquement si le corps < 500 000 caractères.|
|Corps d’élément HTML|Applique le regex sur les premiers 512 Ko des données du corps, mais pas sur le reste du corps au-delà de cette limite. (Le nombre réel de caractères dépend de l’encodage qui peut varier de 1 à 4 octets par caractère.)|Applique l’expression régulière sur les 64 000 premiers caractères (y compris les caractères de balises HTML), mais pas sur le reste du corps au-delà de cette limite.|Active le complément uniquement si le corps < 500 000 caractères.|

Le tableau 3 répertorie les limites et décrit les différences dans les correspondances que chacun des hôtes Outlook renvoie après avoir évalué une expression régulière. La prise en charge est indépendante du type spécifique d’appareil, mais peut dépendre du type de corps d’élément, si l’expression régulière est appliquée sur le corps d’élément.

**Tableau 3. Limites sur les correspondances renvoyées**

||Client riche Outlook|Outlook sur le web ou sur appareils mobiles|
|:-----|:-----|:-----|
|Ordre des correspondances renvoyées|Supposer que **getRegExMatches** renvoie les correspondances pour la même expression régulière appliquée au même élément est différente dans un client riche Outlook que dans Outlook sur le Web ou les appareils mobiles.|Supposer que **getRegExMatches** renvoie les correspondances dans un ordre différent dans un client riche Outlook par rapport à Outlook sur le Web ou aux appareils mobiles.|
|Corps d’élément en texte brut|**getRegExMatches** renvoie les correspondances comprenant 1 536 caractères maximum (1,5 Ko), pour un maximum de 50 correspondances.<br/><br/>**Remarque** : **getRegExMatches** ne renvoie pas les correspondances dans un ordre spécifique dans le tableau renvoyé. En règle générale, supposons que l’ordre des correspondances dans un client riche Outlook pour la même expression régulière appliquée au même élément est différent de celui d’Outlook sur le Web et les appareils mobiles.|**getRegExMatches** renvoie toute correspondance de 3 072 (3 Ko) caractères au maximum, pour un nombre maximal de 50 correspondances.|
|Corps d’élément HTML|**getRegExMatches** renvoie toute correspondance de 3 072 (3 Ko) caractères au maximum, pour un nombre maximal de 50 correspondances.<br/> <br/> **Remarque** : **getRegExMatches** ne renvoie pas les correspondances dans un ordre spécifique dans le tableau renvoyé. En règle générale, supposons que l’ordre des correspondances dans un client riche Outlook pour la même expression régulière appliquée au même élément est différent de celui d’Outlook sur le Web et les appareils mobiles.|**getRegExMatches** renvoie toute correspondance de 3 072 (3 Ko) caractères au maximum, pour un nombre maximal de 50 correspondances.|

## <a name="limits-for-javascript-api"></a>Limites pour l’API JavaScript

À part les recommandations précédentes relatives aux règles d’activation, chacun des hôtes Outlook applique certaines limites dans le modèle objet JavaScript, comme indiqué dans le tableau 4 :

**Tableau 4. Limites relatives à l’obtention ou à la définition de certaines données à l’aide de l’API JavaScript pour Office**

|Fonctionnalité|Limite|API associées|Description|
|:-----|:-----|:-----|:-----|
|Propriétés personnalisées|2 500 caractères|Objet [CustomProperties](/javascript/api/outlook/office.CustomProperties)<br/> <br/>Méthode [item.loadCustomPropertiesAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)|Limite pour toutes les propriétés personnalisées d’un élément de rendez-vous ou de message. Tous les hôtes Outlook renvoient une erreur si la taille totale de toutes les propriétés personnalisées d’un complément dépasse cette limite.|
|Paramètres d’itinérance|32 Ko de caractères|Objet [RoamingSettings](/javascript/api/outlook/office.RoamingSettings)<br/><br/> Propriété [context.roamingSettings](../reference/objectmodel/preview-requirement-set/office.context.md#properties)|Limite pour tous les paramètres d’itinérance du complément. Tous les hôtes Outlook renvoient une erreur si les paramètres dépassent cette limite.|
|Extraction des entités connues|2 000 caractères|Méthode [item.getEntities](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)<br/> <br/>Méthode [item.getEntitiesByType](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)<br/> <br/>Méthode [item.getFilteredEntitiesByName](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)|Limite d’extraction des entités connues sur le corps d’élément pour Exchange Server. Exchange Server ignore les entités au-delà de cette limite. Cette limite est indépendante du fait que le complément utilise une règle **ItemHasKnownEntity** ou non.|
|Services Web Exchange|1 Mo de caractères|Méthode [mailbox.makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)|Limite pour une demande ou une réponse à un appel **Mailbox.makeEwsRequestAsync**.|
|Destinataires|100 destinataires|Propriété [item.requiredAttendees](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)<br/> <br/>Propriété [item.optionalAttendees](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)<br/> <br/>Propriété [item.to](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)<br/> <br/>Propriété [item.cc](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)<br/> <br/>Méthode [Recipients.addAsync](/javascript/api/outlook/office.Recipients#addasync-recipients--options--callback-)<br/> <br/>Méthode [Recipient.getAsync](/javascript/api/outlook/office.Recipients#getasync-options--callback-)<br/> <br/>Méthode [Recipient.setAsync](/javascript/api/outlook/office.Recipients#setasync-recipients--options--callback-)|Limites pour les destinataires spécifiés dans chaque propriété.|
|Nom d’affichage|255 caractères|Propriété [EmailAddressDetails.displayName](/javascript/api/outlook/office.emailaddressdetails#displayname)<br/><br/> Objet [Recipients](/javascript/api/outlook/office.Recipients)<br/><br/> Propriété **item.requiredAttendees**<br/><br/> Propriété **item.optionalAttendees** <br/><br/>Propriété **item.to** <br/><br/>Propriété **item.cc**|Limite pour la longueur du nom d’affichage d’un rendez-vous ou d’un message.|
|Définition de l’objet|255 caractères|Méthode [mailbox.displayNewAppointmentForm](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)<br/><br/> Méthode [Subject.setAsync](/javascript/api/outlook/office.Subject#setasync-subject--options--callback-)|Limite pour l’objet du nouveau formulaire de rendez-vous ou limite pour la définition de l’objet d’un rendez-vous ou d’un message.|
|Définition de l’emplacement|255 caractères|Méthode [Location.setAsync](/javascript/api/outlook/office.Location#setasync-location--options--callback-)|Limite pour la définition de l’emplacement d’un rendez-vous ou d’une demande de réunion.|
|Corps dans un nouveau formulaire de rendez-vous|32 Ko de caractères|Méthode **Mailbox.displayNewAppointmentForm**|Limite pour le corps dans un nouveau formulaire de rendez-vous.|
|Affichage du corps d’un élément existant|32 Ko de caractères|Méthode [mailbox.displayAppointmentForm](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)<br/><br/> Méthode [mailbox.displayMessageForm](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)|Pour Outlook sur le Web et les appareils mobiles : limite pour le corps dans un formulaire de rendez-vous ou de message existant.|
|Définition du corps|1 Mo de caractères|Méthode [Body.prependAsync](/javascript/api/outlook/office.Body#prependasync-data--options--callback-)<br/> <br/>[Body.setAsync](/javascript/api/outlook/office.Body#setasync-data--options--callback-)<br/><br/>Méthode [Body.setSelectedDataAsync](/javascript/api/outlook/office.Body#setselecteddataasync-data--options--callback-)|Limite pour la définition du corps d’un élément de rendez-vous ou de message.|
|Nombre de pièces jointes|499 fichiers sur Outlook sur le Web et les appareils mobiles|Méthode [item.addFileAttachmentAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)|Limite du nombre de fichiers pouvant être joints à un élément à envoyer. Outlook sur le Web et les appareils mobiles limite généralement la connexion de jusqu’à 499 fichiers par le biais de l’interface utilisateur et de **addFileAttachmentAsync**. Un client riche Outlook ne limite pas spécifiquement le nombre de pièces jointes. Cependant, tous les hôtes Outlook respectent la limite de taille des pièces jointes définie sur le serveur Exchange Server de l’utilisateur. Reportez-vous à la ligne suivante pour connaître la taille des pièces jointes.|
|Taille des pièces jointes|En fonction du serveur Exchange Server|Méthode **item.addFileAttachmentAsync**|La taille de toutes les pièces jointes d’un élément est limitée ; l’administrateur peut définir cette limite sur le serveur Exchange Server de la boîte aux lettres de l’utilisateur.Pour un client riche Outlook, limite le nombre de pièces jointes d’un élément. Pour Outlook sur le Web et les appareils mobiles, la plus petite des deux limites, le nombre de pièces jointes et la taille de toutes les pièces jointes, limite les pièces jointes réelles pour un élément.|
|Nom de fichier des pièces jointes|255 caractères|Méthode **item.addFileAttachmentAsync**|Limite pour la longueur du nom de fichier d’une pièce jointe à ajouter à un élément.|
|URI des pièces jointes|2 048 caractères|Méthode **item.addFileAttachmentAsync**|Limite pour l’URI du nom de fichier à ajouter en tant que pièce jointe à un élément.|
|ID des pièces jointes|100 caractères|Méthode [item.addItemAttachmentAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)<br/><br/> Méthode [item.removeAttachmentAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)|Limite pour la longueur de l’ID de la pièce jointe à ajouter à un élément ou à supprimer d’un élément.|
|Appels asynchrones|3 appels|Méthode **item.addFileAttachmentAsync**<br/><br/>Méthode **item.addItemAttachmentAsync**<br/><br/><br/>Méthode **item.removeAttachmentAsync**<br/><br/> Méthode [Body.getTypeAsync](/javascript/api/outlook/office.Body#gettypeasync-options--callback-)<br/><br/>Méthode **Body.prependAsync**<br/><br/>Méthode **Body.setSelectedDataAsync**<br/><br/> Méthode [CustomProperties.saveAsync](/javascript/api/outlook/office.CustomProperties#saveasync-callback--asynccontext-)<br/><br/><br/> Méthode [item.LoadCustomPropertiesAysnc](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)<br/><br/><br/> Méthode [Location.getAsync](/javascript/api/outlook/office.Location#getasync-options--callback-)<br/><br/>Méthode **Location.setAsync**<br/><br/> Méthode [mailbox.getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)<br/><br/> Méthode [mailbox.getUserIdentityTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)<br/><br/> Méthode [mailbox.makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)<br/><br/>Méthode **Recipients.addAsync**<br/><br/> Méthode [Recipients.getAsync](/javascript/api/outlook/office.Recipients#getasync-options--callback-)<br/><br/>Méthode **Recipients.setAsync**<br/><br/> Méthode [RoamingSettings.saveAsync](/javascript/api/outlook/office.RoamingSettings#saveasync-callback-)<br/><br/> Méthode [Subject.getAsync](/javascript/api/outlook/office.Subject#getasync-options--callback-)<br/><br/>Méthode **Subject.setAsync**<br/><br/> Méthode [Time.getAsync](/javascript/api/outlook/office.Time#getasync-options--callback-)<br/><br/> Méthode [Time.setAsync](/javascript/api/outlook/office.Time#setasync-datetime--options--callback-)|Pour Outlook sur le Web ou les appareils mobiles : limite du nombre d’appels asynchrones simultanés à la fois, car les navigateurs autorisent uniquement un nombre limité d’appels asynchrones aux serveurs. |

## <a name="see-also"></a>Voir aussi

- [Déployer et installer des compléments Outlook à des fins de test](testing-and-tips.md)
- [Confidentialité, autorisations et sécurité pour les compléments Outlook](../develop/privacy-and-security.md)
