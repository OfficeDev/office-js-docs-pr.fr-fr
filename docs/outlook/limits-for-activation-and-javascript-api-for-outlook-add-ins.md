---
title: Limites pour l’activation et l’utilisation des API dans des compléments Outlook
description: Tenez compte de certaines instructions relatives à l’activation et l’utilisation des API et implémentez vos compléments pour respecter ces limites.
ms.date: 06/11/2021
localization_priority: Normal
ms.openlocfilehash: b1d948add382f19083f099ed7a01b4f954555b6f
ms.sourcegitcommit: 3fa8c754a47bab909e559ae3e5d4237ba27fdbe4
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/30/2021
ms.locfileid: "53671778"
---
# <a name="limits-for-activation-and-javascript-api-for-outlook-add-ins"></a>Limites pour l’activation et l’API JavaScript pour les compléments Outlook

Pour offrir une expérience satisfaisante aux utilisateurs de compléments Outlook, il convient de connaître certaines recommandations relatives à l’activation et à l’utilisation de l’API afin d’implémenter vos compléments tout en respectant ces limites. Ces instructions existent afin qu’un complément individuel ne puisse pas exiger que Exchange Server ou Outlook passe un temps anormalement long pour traiter ses règles d’activation ou appels à l’API JavaScript Office, ce qui a une incidence sur l’expérience utilisateur globale pour Outlook et d’autres compléments. Ces limites s’appliquent à la conception de règles d’activation dans le manifeste du complément, à l’utilisation de propriétés personnalisées, de paramètres d’itinérance, de destinataires, de demandes et de réponses EWS (Exchange Web Services) et d’appels asynchrones.

> [!NOTE]
> Si votre complément s’exécute sur un client riche Outlook, vous devez également vérifier que le complément s’exécute dans certaines limites d’utilisation des ressources au moment de l’exécution.

## <a name="limits-on-where-add-ins-activate"></a>Limites relatives à l’emplacement d’activation des compléments

Pour en savoir plus sur les points d’activation et d’activation des modules, consultez la [section](outlook-add-ins-overview.md#mailbox-items-available-to-add-ins) Éléments de boîte aux lettres disponibles pour les Outlook de la page de présentation des Outlook.

## <a name="limits-for-activation-rules"></a>Limites pour les règles d’activation

Suivez les recommandations ci-dessous lors de la création de règles d’activation pour les compléments Outlook :

- Limitez la taille du manifeste à 256 Ko. Vous ne pouvez pas installer le complément Outlook pour une boîte aux lettres Exchange si vous dépassez cette limite.

- Spécifiez jusqu’à quinze règles d’activation pour le complément. Vous ne pouvez pas installer le complément si vous dépassez cette limite.

- Si vous appliquez une règle [ItemHasKnownEntity](../reference/manifest/rule.md#itemhasknownentity-rule) au corps de l’élément sélectionné, attendez-vous à ce qu’un client riche Outlook n’applique la règle qu’au premier mégaoctet du corps et non au reste du corps compris au-delà de cette limite. Votre complément ne sera pas activé s’il existe uniquement des correspondances comprises au-delà du premier mégaoctet du corps. Si ce scénario vous semble probable, redéfinissez vos conditions relatives à l’activation.

- Si vous utilisez des expressions régulières dans ou des règles `ItemHasKnownEntity` [ItemHasRegularExpressionMatch,](../reference/manifest/rule.md#itemhasregularexpressionmatch-rule) n’ignorez pas les limites et instructions suivantes qui s’appliquent généralement à n’importe quelle application Outlook, et celles décrites dans les tableaux 1, 2 et 3 qui diffèrent en fonction de l’application.
  - Spécifiez au maximum cinq expressions régulières dans les règles d’activation d’un complément. Vous ne pouvez pas installer un complément si vous dépassez cette limite.
  - Spécifiez des expressions régulières pour que les résultats que vous prévoyez soient renvoyés par l’appel de méthode `getRegExMatches` dans les 50 premières correspondances.
  - Peut spécifier des assertions avant dans les expressions régulières, mais pas d’assertions arrière, `(?<=text)`, ni d’assertions arrière négatives `(?<!text)`.

Le tableau 1 répertorie les limites et décrit les différences dans la prise en charge des expressions régulières entre un client Outlook riche et des appareils Outlook sur le web ou mobiles. The support is independent of any specific type of device and item body.

**Tableau 1. Différences générales dans la prise en charge des expressions régulières**

|Client riche Outlook|Outlook sur le web ou sur appareils mobiles|
|:-----|:-----|
|Utilise le moteur d’expression régulière C++ fourni dans le cadre de la bibliothèque de modèles standard Visual Studio. Ce moteur est conforme aux normes ECMAScript 5. |Utilise l’évaluation d’expression régulière incluse dans JavaScript ; celle-ci est fournie par le navigateur et prend en charge un sur-ensemble d’ECMAScript 5.|
|En raison des différents moteurs d’regex, une regex qui inclut une classe de caractères personnalisée basée sur des classes de caractères prédéfines peut renvoyer des résultats différents dans un client riche Outlook par rapport aux appareils mobiles ou Outlook sur le web.<br/><br/>Par exemple, l’expression régulière `[\s\S]{0,100}` correspond à tout nombre, compris entre 0 et 100, de caractères uniques correspondant à un espace blanc ou à un espace non blanc. Cette regex renvoie des résultats différents dans un client Outlook riche que les Outlook sur le web et les appareils mobiles.<br/><br/>Comme solution de contournement, vous devez réécrire l’expression régulière de la manière suivante : `(\s\|\S){0,100}`. Cette expression régulière correspond à un nombre, compris entre 0 et 100, d’espace blanc ou d’espace non blanc.<br/><br/>Vous devez tester minutieusement chaque regex sur chaque client Outlook, et si une regex renvoie des résultats différents, réécrivez l’regex. |Vous devez tester minutieusement chaque regex sur chaque client Outlook, et si une regex renvoie des résultats différents, réécrivez l’regex.|
|Par défaut, limite l’évaluation de toutes les expressions régulières pour un complément à 1 seconde. Le dépassement de cette limite engendre une réévaluation à 3 reprises au maximum. Au-delà de la limite de réévaluation, un client Outlook riche désactive l’exécution du Outlook pour la même boîte aux lettres.<br/><br/>Les administrateurs peuvent remplacer ces limites d’évaluation à l’aide des clés de Registre et des `OutlookActivationAlertThreshold` `OutlookActivationManagerRetryLimit` clés de Registre.|Ne prend pas en charge les mêmes paramètres de surveillance des ressources ou du Registre que dans un client riche Outlook. Toutefois, les add-ins avec des expressions régulières qui nécessitent un temps d’évaluation excessif sur un client riche Outlook sont désactivés pour la même boîte aux lettres sur tous les clients Outlook client.|

Le tableau 2 répertorie les limites et décrit les différences dans la partie du corps d’élément auquel chaque hôte Outlook applique une expression régulière. Certaines de ces limites dépendent du type d’appareil et de corps d’élément, si l’expression régulière est appliquée sur le corps d’élément.

**Tableau 2. Limites de la taille du corps d’élément évalué**

||Client riche Outlook|Outlook sur les appareils mobiles|Outlook sur le web|
|:-----|:-----|:-----|:-----|
|**Facteur de forme**|Tout appareil pris en charge|Smartphones Android, iPad ou iPhone|Tout appareil pris en charge autre que les smartphones Android, l’iPad et l’iPhone|
|**Corps d’élément en texte brut**|Applique le regex sur le premier mégaoctet des données du corps, mais pas sur le reste du corps au-delà de cette limite.|Active le complément uniquement si le corps < 16 000 caractères.|Active le complément uniquement si le corps < 500 000 caractères.|
|**Corps d’élément HTML**|Applique le regex sur les premiers 512 Ko des données du corps, mais pas sur le reste du corps au-delà de cette limite. (Le nombre réel de caractères dépend de l’encodage qui peut varier de 1 à 4 octets par caractère.)|Applique l’expression régulière sur les 64 000 premiers caractères (y compris les caractères de balises HTML), mais pas sur le reste du corps au-delà de cette limite.|Active le complément uniquement si le corps < 500 000 caractères.|

Le tableau 3 répertorie les limites et décrit les différences entre les correspondances que chaque client Outlook après avoir évalué une expression régulière. La prise en charge est indépendante du type spécifique d’appareil, mais peut dépendre du type de corps d’élément, si l’expression régulière est appliquée sur le corps d’élément.

**Tableau 3. Limites sur les correspondances renvoyées**

||Client riche Outlook|Outlook sur le web ou sur appareils mobiles|
|:-----|:-----|:-----|
|**Ordre des correspondances renvoyées**|Supposons que les correspondances pour la même expression régulière appliquée au même élément sont différentes dans un client riche Outlook que dans les appareils Outlook sur le web ou `getRegExMatches` mobiles.|Supposons que les correspondances sont renvoient dans un ordre différent Outlook client riche que dans Outlook sur le web `getRegExMatches` ou appareils mobiles.|
|**Corps d’élément en texte brut**|`getRegExMatches` renvoie toutes les correspondances d’un maximum de 1 536 caractères (1,5 Ko), pour un maximum de 50 correspondances.<br/><br/>**Remarque**: `getRegExMatches` ne retourne pas de correspondances dans un ordre spécifique dans le tableau renvoyé. En règle générale, supposons que l’ordre des correspondances dans un client riche Outlook pour la même expression régulière appliquée au même élément est différent de celui des appareils mobiles et Outlook sur le web.|`getRegExMatches` renvoie toutes les correspondances d’un maximum de 3 072 caractères (3 Ko), pour un maximum de 50 correspondances.|
|**Corps d’élément HTML**|`getRegExMatches` renvoie toutes les correspondances d’un maximum de 3 072 caractères (3 Ko), pour un maximum de 50 correspondances.<br/> <br/> **Remarque**: `getRegExMatches` ne retourne pas de correspondances dans un ordre spécifique dans le tableau renvoyé. En règle générale, supposons que l’ordre des correspondances dans un client riche Outlook pour la même expression régulière appliquée au même élément est différent de celui des appareils mobiles et Outlook sur le web.|`getRegExMatches` renvoie toutes les correspondances d’un maximum de 3 072 caractères (3 Ko), pour un maximum de 50 correspondances.|

## <a name="limits-for-javascript-api"></a>Limites pour l’API JavaScript

Outre les recommandations précédentes en matière de règles d’activation, chaque client Outlook applique certaines limites dans le modèle objet JavaScript, comme décrit dans le tableau 4.

**Tableau 4. Limites pour obtenir ou définir certaines données à l’aide de l Office API JavaScript**

|Fonctionnalité|Limite|API associées|Description|
|:-----|:-----|:-----|:-----|
|Propriétés personnalisées|2 500 caractères|Objet [CustomProperties](/javascript/api/outlook/office.customproperties)<br/> <br/>Méthode [item.loadCustomPropertiesAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)|Limite pour toutes les propriétés personnalisées d’un élément de rendez-vous ou de message. Tous les clients Outlook renvoyer une erreur si la taille totale de toutes les propriétés personnalisées d’un add-in dépasse cette limite.|
|Paramètres d’itinérance|32 Ko de caractères|Objet [RoamingSettings](/javascript/api/outlook/office.roamingsettings)<br/><br/> Propriété [context.roamingSettings](../reference/objectmodel/preview-requirement-set/office.context.md#properties)|Limite pour tous les paramètres d’itinérance du complément. Tous les clients Outlook renvoyer une erreur si vos paramètres dépassent cette limite.|
|Extraction des entités connues|2 000 caractères|Méthode [item.getEntities](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)<br/> <br/>Méthode [item.getEntitiesByType](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)<br/> <br/>Méthode [item.getFilteredEntitiesByName](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)|Limite d’extraction des entités connues sur le corps d’élément pour Exchange Server. Le serveur Exchange Server ignore les entités au-delà de cette limite. Notez que cette limite est indépendante de l’utilisation ou non d’une règle par le `ItemHasKnownEntity` add-in.|
|Services web Exchange|1 Mo de caractères|Méthode [mailbox.makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)|Limite pour une demande ou une réponse à un `Mailbox.makeEwsRequestAsync` appel.|
|Destinataires|100 destinataires|Propriété [item.requiredAttendees](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)<br/> <br/>Propriété [item.optionalAttendees](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)<br/> <br/>Propriété [item.to](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)<br/> <br/>Propriété [item.cc](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)<br/> <br/>Méthode [Recipients.addAsync](/javascript/api/outlook/office.recipients#addAsync_recipients__options__callback_)<br/> <br/>Méthode [Recipient.getAsync](/javascript/api/outlook/office.recipients#getAsync_options__callback_)<br/> <br/>Méthode [Recipient.setAsync](/javascript/api/outlook/office.recipients#setAsync_recipients__options__callback_)|Limites pour les destinataires spécifiés dans chaque propriété.|
|Nom d’affichage|255 caractères|Propriété [EmailAddressDetails.displayName](/javascript/api/outlook/office.emailaddressdetails#displayName)<br/><br/> Objet [Recipients](/javascript/api/outlook/office.recipients)<br/><br/> `item.requiredAttendees` property<br/><br/> `item.optionalAttendees` property <br/><br/>`item.to` property <br/><br/>`item.cc` property|Limite pour la longueur du nom d’affichage d’un rendez-vous ou d’un message.|
|Définition de l’objet|255 caractères|Méthode [mailbox.displayNewAppointmentForm](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)<br/><br/> Méthode [Subject.setAsync](/javascript/api/outlook/office.subject#setAsync_subject__options__callback_)|Limite pour l’objet du nouveau formulaire de rendez-vous ou limite pour la définition de l’objet d’un rendez-vous ou d’un message.|
|Définition de l’emplacement|255 caractères|Méthode [Location.setAsync](/javascript/api/outlook/office.location#setAsync_location__options__callback_)|Limite pour la définition de l’emplacement d’un rendez-vous ou d’une demande de réunion.|
|Corps dans un nouveau formulaire de rendez-vous|32 Ko de caractères|`Mailbox.displayNewAppointmentForm` méthode|Limite pour le corps dans un nouveau formulaire de rendez-vous.|
|Affichage du corps d’un élément existant|32 Ko de caractères|Méthode [mailbox.displayAppointmentForm](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)<br/><br/> Méthode [mailbox.displayMessageForm](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)|Pour Outlook sur le web mobiles et mobiles : limite pour le corps dans un formulaire de rendez-vous ou de message existant.|
|Définition du corps|1 Mo de caractères|Méthode [Body.prependAsync](/javascript/api/outlook/office.body#prependAsync_data__options__callback_)<br/> <br/>[Body.setAsync](/javascript/api/outlook/office.body#setAsync_data__options__callback_)<br/><br/>Méthode [Body.setSelectedDataAsync](/javascript/api/outlook/office.body#setSelectedDataAsync_data__options__callback_)|Limite pour la définition du corps d’un élément de rendez-vous ou de message.|
|Nombre de pièces jointes|499 fichiers sur Outlook sur le web appareils mobiles et mobiles|Méthode [item.addFileAttachmentAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)|Limite du nombre de fichiers pouvant être joints à un élément à envoyer. Outlook sur le web appareils mobiles et mobiles limitent généralement l’attachement jusqu’à 499 fichiers, via l’interface utilisateur et `addFileAttachmentAsync` . Un client riche Outlook ne limite pas spécifiquement le nombre de pièces jointes. Toutefois, tous Outlook clients respectent la limite de taille des pièces jointes avec Exchange Server’utilisateur a été configurée. Reportez-vous à la ligne suivante pour connaître la taille des pièces jointes.|
|Taille des pièces jointes|En fonction du serveur Exchange Server|`item.addFileAttachmentAsync` méthode|La taille de toutes les pièces jointes d’un élément est limitée ; l’administrateur peut définir cette limite sur le serveur Exchange Server de la boîte aux lettres de l’utilisateur.Pour un client riche Outlook, limite le nombre de pièces jointes d’un élément. Pour Outlook sur le web et les appareils mobiles, la limite la plus faible des deux limites (le nombre de pièces jointes et la taille de toutes les pièces jointes) limite les pièces jointes réelles d’un élément.|
|Nom de fichier des pièces jointes|255 caractères|`item.addFileAttachmentAsync` méthode|Limite pour la longueur du nom de fichier d’une pièce jointe à ajouter à un élément.|
|URI des pièces jointes|2 048 caractères|`item.addFileAttachmentAsync` méthode|Limite pour l’URI du nom de fichier à ajouter en tant que pièce jointe à un élément.|
|ID des pièces jointes|100 caractères|Méthode [item.addItemAttachmentAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)<br/><br/> Méthode [item.removeAttachmentAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)|Limite pour la longueur de l’ID de la pièce jointe à ajouter à un élément ou à supprimer d’un élément.|
|Appels asynchrones|3 appels|`item.addFileAttachmentAsync` méthode<br/><br/>`item.addItemAttachmentAsync` méthode<br/><br/><br/>`item.removeAttachmentAsync` méthode<br/><br/> Méthode [Body.getTypeAsync](/javascript/api/outlook/office.body#getTypeAsync_options__callback_)<br/><br/>`Body.prependAsync` méthode<br/><br/>`Body.setSelectedDataAsync` méthode<br/><br/> Méthode [CustomProperties.saveAsync](/javascript/api/outlook/office.customproperties#saveAsync_callback__asyncContext_)<br/><br/><br/> [élément. Méthode LoadCustomPropertiesAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#methods)<br/><br/><br/> Méthode [Location.getAsync](/javascript/api/outlook/office.location#getAsync_options__callback_)<br/><br/>`Location.setAsync` méthode<br/><br/> Méthode [mailbox.getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)<br/><br/> Méthode [mailbox.getUserIdentityTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)<br/><br/> Méthode [mailbox.makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)<br/><br/>`Recipients.addAsync` méthode<br/><br/> Méthode [Recipients.getAsync](/javascript/api/outlook/office.recipients#getAsync_options__callback_)<br/><br/>`Recipients.setAsync` méthode<br/><br/> Méthode [RoamingSettings.saveAsync](/javascript/api/outlook/office.roamingsettings#saveAsync_callback_)<br/><br/> Méthode [Subject.getAsync](/javascript/api/outlook/office.subject#getAsync_options__callback_)<br/><br/>`Subject.setAsync` méthode<br/><br/> Méthode [Time.getAsync](/javascript/api/outlook/office.time#getAsync_options__callback_)<br/><br/> Méthode [Time.setAsync](/javascript/api/outlook/office.time#setAsync_dateTime__options__callback_)|Pour Outlook sur le web ou appareils mobiles : limite du nombre d’appels asynchrones simultanés à la fois, car les navigateurs autorisent uniquement un nombre limité d’appels asynchrones aux serveurs. |

## <a name="see-also"></a>Voir aussi

- [Déployer et installer des compléments Outlook à des fins de test](testing-and-tips.md)
- [Confidentialité, autorisations et sécurité pour les compléments Outlook](../concepts/privacy-and-security.md)
