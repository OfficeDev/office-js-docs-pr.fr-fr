---
title: Limites pour l’activation et l’utilisation des API dans des compléments Outlook
description: Tenez compte de certaines instructions relatives à l’activation et l’utilisation des API et implémentez vos compléments pour respecter ces limites.
ms.date: 08/30/2022
ms.localizationpriority: medium
ms.openlocfilehash: b09886e49b0d980dbbf2465df7d077cd16a04f4d
ms.sourcegitcommit: 889d23061a9413deebf9092d675655f13704c727
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/07/2022
ms.locfileid: "67616013"
---
# <a name="limits-for-activation-and-javascript-api-for-outlook-add-ins"></a>Limites pour l’activation et l’API JavaScript pour les compléments Outlook

Pour offrir une expérience satisfaisante aux utilisateurs de compléments Outlook, il convient de connaître certaines recommandations relatives à l’activation et à l’utilisation de l’API afin d’implémenter vos compléments tout en respectant ces limites. Ces instructions existent afin qu’un complément individuel ne puisse pas exiger que Exchange Server ou Outlook passent une période anormalement longue pour traiter ses règles d’activation ou appels à l’API JavaScript Office, ce qui affecte l’expérience utilisateur globale d’Outlook et d’autres compléments. Ces limites s’appliquent à la conception de règles d’activation dans le manifeste du complément et à l’utilisation de propriétés personnalisées, de paramètres d’itinérance, de destinataires, de demandes et de réponses Exchange Web Services (EWS) et d’appels asynchrones.

> [!NOTE]
> Si votre complément s’exécute sur un client riche Outlook, vous devez également vérifier que le complément s’exécute dans certaines limites d’utilisation des ressources d’exécution.

## <a name="limits-on-where-add-ins-activate"></a>Limites relatives à l’emplacement d’activation des compléments

Pour en savoir plus sur l’endroit où les compléments s’activent et ne s’activent pas, reportez-vous à la section Éléments de boîte aux [lettres disponibles pour les compléments](outlook-add-ins-overview.md#mailbox-items-available-to-add-ins) de la page vue d’ensemble des compléments Outlook.

## <a name="limits-for-activation-rules"></a>Limites pour les règles d’activation

Suivez les recommandations ci-dessous lors de la création de règles d’activation pour les compléments Outlook :

- Limitez la taille du manifeste à 256 Ko. Vous ne pouvez pas installer le complément Outlook pour une boîte aux lettres Exchange si vous dépassez cette limite.

- Spécifiez jusqu’à quinze règles d’activation pour le complément. Vous ne pouvez pas installer le complément si vous dépassez cette limite.

- Si vous appliquez une règle [ItemHasKnownEntity](/javascript/api/manifest/rule#itemhasknownentity-rule) au corps de l’élément sélectionné, attendez-vous à ce qu’un client riche Outlook n’applique la règle qu’au premier mégaoctet du corps et non au reste du corps compris au-delà de cette limite. Votre complément n’est pas activé si les correspondances existent uniquement après le premier Mo du corps. Si ce scénario vous semble probable, redéfinissez vos conditions relatives à l’activation.

- Si vous utilisez des expressions régulières dans `ItemHasKnownEntity` ou des règles [ItemHasRegularExpressionMatch](/javascript/api/manifest/rule#itemhasregularexpressionmatch-rule) , tenez compte des limites et instructions suivantes qui s’appliquent généralement à n’importe quelle application Outlook, ainsi que celles décrites dans les tableaux 1, 2 et 3 qui diffèrent en fonction de l’application.
  - Spécifiez jusqu’à cinq expressions régulières dans les règles d’activation dans un complément. Vous ne pouvez pas installer un complément si vous dépassez cette limite.
  - Spécifiez des expressions régulières de sorte que les résultats que vous prévoyez soient retournés par l’appel `getRegExMatches` de méthode dans les 50 premières correspondances.
  - **Important** : le texte est mis en surbrillance en fonction des chaînes qui résultent de la mise en correspondance de l’expression régulière. Toutefois, les occurrences mises en surbrillance peuvent ne pas correspondre exactement à ce qui doit résulter d’assertions d’expression régulière réelles telles que la recherche `(?!text)`négative, la recherche en arrière-plan `(?<=text)`et la recherche négative.`(?<!text)` Par exemple, si vous utilisez l’expression `under(?!score)` régulière sur « Comme sous, sous score et trait de soulignement », la chaîne « under » est mise en surbrillance pour toutes les occurrences au lieu des deux premières.

Le tableau 1 répertorie les limites et décrit les différences de prise en charge des expressions régulières entre un client riche Outlook et des appareils Outlook sur le web ou mobiles. The support is independent of any specific type of device and item body.

**Tableau 1. Différences générales dans la prise en charge des expressions régulières**

|Client riche Outlook|Outlook sur le web ou sur appareils mobiles|
|:-----|:-----|
|Utilise le moteur d’expression régulière C++ fourni dans le cadre de la bibliothèque de modèles standard Visual Studio. Ce moteur est conforme aux normes ECMAScript 5. |Utilise l’évaluation d’expression régulière incluse dans JavaScript ; celle-ci est fournie par le navigateur et prend en charge un sur-ensemble d’ECMAScript 5.|
|En raison des différents moteurs regex, attendez-vous à ce qu’un regex qui inclut une classe de caractères personnalisée basée sur des classes de caractères prédéfinies retourne des résultats différents dans un client riche Outlook que dans Outlook sur le web ou des appareils mobiles.<br/><br/>Par exemple, l’expression `[\s\S]{0,100}` régulière correspond à n’importe quel nombre, compris entre 0 et 100, de caractères uniques qui est un espace blanc ou un espace non blanc. Cette expression régulière retourne des résultats différents dans un client riche Outlook que Outlook sur le web et les appareils mobiles.<br/><br/>Vous devez réécrire le regex comme `(\s\|\S){0,100}` solution de contournement. Cette expression régulière correspond à un nombre, compris entre 0 et 100, d’espace blanc ou d’espace non blanc.<br/><br/>Vous devez tester soigneusement chaque expression régulière sur chaque client Outlook, et si un regex retourne des résultats différents, réécrivez le regex. |Vous devez tester soigneusement chaque expression régulière sur chaque client Outlook, et si un regex retourne des résultats différents, réécrivez le regex.|
|Par défaut, limite l’évaluation de toutes les expressions régulières pour un complément à 1 seconde. Le dépassement de cette limite engendre une réévaluation à 3 reprises au maximum. Au-delà de la limite de réévaluation, un client riche Outlook désactive l’exécution du complément pour la même boîte aux lettres dans l’un des clients Outlook.<br/><br/>Les administrateurs peuvent remplacer ces limites d’évaluation à l’aide des clés de Registre et `OutlookActivationManagerRetryLimit` des `OutlookActivationAlertThreshold` clés.|Ne prenez pas en charge les mêmes paramètres de surveillance des ressources ou de Registre que dans un client riche Outlook. Toutefois, les compléments avec des expressions régulières qui nécessitent un temps d’évaluation excessif sur un client riche Outlook sont désactivés pour la même boîte aux lettres sur tous les clients Outlook.|

Le tableau 2 répertorie les limites et décrit les différences dans la partie du corps d’élément auquel chaque hôte Outlook applique une expression régulière. Certaines de ces limites dépendent du type d’appareil et de corps d’élément, si l’expression régulière est appliquée sur le corps d’élément.

**Tableau 2. Limites de la taille du corps d’élément évalué**

||Client riche Outlook|Outlook sur les appareils mobiles|Outlook sur le web|
|:-----|:-----|:-----|:-----|
|**Facteur de forme**|Tout appareil pris en charge.|Smartphones Android, iPad ou iPhone.|Tout appareil pris en charge autre que les smartphones Android, iPad et iPhone.|
|**Corps d’élément en texte brut**|Applique le regex sur le premier mégaoctet des données du corps, mais pas sur le reste du corps au-delà de cette limite.|Active le complément uniquement si le corps < 16 000 caractères.|Active le complément uniquement si le corps < 500 000 caractères.|
|**Corps d’élément HTML**|Applique le regex sur les premiers 512 Ko des données du corps, mais pas sur le reste du corps au-delà de cette limite. (Le nombre réel de caractères dépend de l’encodage qui peut varier de 1 à 4 octets par caractère.)|Applique l’expression régulière sur les 64 000 premiers caractères (y compris les caractères de balises HTML), mais pas sur le reste du corps au-delà de cette limite.|Active le complément uniquement si le corps < 500 000 caractères.|

Le tableau 3 répertorie les limites et décrit les différences entre les correspondances retournées par chaque client Outlook après l’évaluation d’une expression régulière. La prise en charge est indépendante du type spécifique d’appareil, mais peut dépendre du type de corps d’élément, si l’expression régulière est appliquée sur le corps d’élément.

**Tableau 3. Limites sur les correspondances renvoyées**

||Client riche Outlook|Outlook sur le web ou sur appareils mobiles|
|:-----|:-----|:-----|
|**Ordre des correspondances renvoyées**|Supposons que `getRegExMatches` les correspondances de la même expression régulière appliquée sur le même élément soient différentes dans un client riche Outlook que dans Outlook sur le web ou des appareils mobiles.|Supposons que `getRegExMatches` les correspondances sont retournées dans un ordre différent dans un client riche Outlook que dans Outlook sur le web ou des appareils mobiles.|
|**Corps d’élément en texte brut**|`getRegExMatches` retourne toutes les correspondances d’un maximum de 1 536 caractères (1,5 Ko), pour un maximum de 50 correspondances.<br/><br/>**Remarque** : `getRegExMatches` ne retourne pas de correspondances dans un ordre spécifique dans le tableau retourné. En général, supposons que l’ordre des correspondances dans un client riche Outlook pour la même expression régulière appliquée sur le même élément soit différent de celui des appareils mobiles et Outlook sur le web.|`getRegExMatches` retourne toutes les correspondances d’un maximum de 3 072 caractères (3 Ko), pour un maximum de 50 correspondances.|
|**Corps d’élément HTML**|`getRegExMatches` retourne toutes les correspondances d’un maximum de 3 072 caractères (3 Ko), pour un maximum de 50 correspondances.<br/> <br/> **Remarque** : `getRegExMatches` ne retourne pas de correspondances dans un ordre spécifique dans le tableau retourné. En général, supposons que l’ordre des correspondances dans un client riche Outlook pour la même expression régulière appliquée sur le même élément soit différent de celui des appareils mobiles et Outlook sur le web.|`getRegExMatches` retourne toutes les correspondances d’un maximum de 3 072 caractères (3 Ko), pour un maximum de 50 correspondances.|

## <a name="limits-for-javascript-api"></a>Limites pour l’API JavaScript

Outre les instructions précédentes pour les règles d’activation, chaque client Outlook applique certaines limites dans le modèle objet JavaScript, comme décrit dans le tableau 4.

**Tableau 4. Limites pour obtenir ou définir certaines données à l’aide de l’API JavaScript Office**

|Fonctionnalité|Limite|API associées|Description|
|:-----|:-----|:-----|:-----|
|Propriétés personnalisées|2 500 caractères|Objet [CustomProperties](/javascript/api/outlook/office.customproperties)<br/> <br/>Méthode [item.loadCustomPropertiesAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)|Limite pour toutes les propriétés personnalisées d’un élément de rendez-vous ou de message. Tous les clients Outlook retournent une erreur si la taille totale de toutes les propriétés personnalisées d’un complément dépasse cette limite.|
|Paramètres d’itinérance|32 Ko de caractères|Objet [RoamingSettings](/javascript/api/outlook/office.roamingsettings)<br/><br/> Propriété [context.roamingSettings](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context#properties)|Limite pour tous les paramètres d’itinérance du complément. Tous les clients Outlook retournent une erreur si vos paramètres dépassent cette limite.|
|En-têtes Internet|256 Ko par message dans Exchange Online<br/><br/>Limite de taille d’en-tête déterminée par les administrateurs de l’organisation dans Exchange en local|[Méthode InternetHeaders.setAsync](/javascript/api/outlook/office.internetheaders)|Limite de taille totale des en-têtes qui peuvent être appliqués à un message.|
|Extraction des entités connues|2 000 caractères|Méthode [item.getEntities](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)<br/> <br/>Méthode [item.getEntitiesByType](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)<br/> <br/>Méthode [item.getFilteredEntitiesByName](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)|Limite d’extraction des entités connues sur le corps d’élément pour Exchange Server. Le serveur Exchange Server ignore les entités au-delà de cette limite. Notez que cette limite est indépendante de l’utilisation ou non d’une `ItemHasKnownEntity` règle par le complément.|
|Services web Exchange|1 Mo de caractères|Méthode [mailbox.makeEwsRequestAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)|Limite pour une demande ou une réponse à un `Mailbox.makeEwsRequestAsync` appel.|
|Destinataires|100 destinataires|Propriété [item.requiredAttendees](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#properties)<br/> <br/>Propriété [item.optionalAttendees](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#properties)<br/> <br/>Propriété [item.to](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#properties)<br/> <br/>Propriété [item.cc](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#properties)<br/> <br/>Méthode [Recipients.addAsync](/javascript/api/outlook/office.recipients#outlook-office-recipients-addasync-member(1))<br/> <br/>Méthode [Recipient.getAsync](/javascript/api/outlook/office.recipients#outlook-office-recipients-getasync-member(1))<br/> <br/>Méthode [Recipient.setAsync](/javascript/api/outlook/office.recipients#outlook-office-recipients-setasync-member(1))|Limites pour les destinataires spécifiés dans chaque propriété.|
|Nom d’affichage|255 caractères|Propriété [EmailAddressDetails.displayName](/javascript/api/outlook/office.emailaddressdetails#outlook-office-emailaddressdetails-displayname-member)<br/><br/> Objet [Recipients](/javascript/api/outlook/office.recipients)<br/><br/> `item.requiredAttendees` Propriété<br/><br/> `item.optionalAttendees` Propriété <br/><br/>`item.to` Propriété <br/><br/>`item.cc` Propriété|Limite pour la longueur du nom d’affichage d’un rendez-vous ou d’un message.|
|Définition de l’objet|255 caractères|Méthode [mailbox.displayNewAppointmentForm](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)<br/><br/> Méthode [Subject.setAsync](/javascript/api/outlook/office.subject#outlook-office-subject-setasync-member(1))|Limite pour l’objet du nouveau formulaire de rendez-vous ou limite pour la définition de l’objet d’un rendez-vous ou d’un message.|
|Définition de l’emplacement|255 caractères|Méthode [Location.setAsync](/javascript/api/outlook/office.location#outlook-office-location-setasync-member(1))|Limite pour la définition de l’emplacement d’un rendez-vous ou d’une demande de réunion.|
|Corps dans un nouveau formulaire de rendez-vous|32 Ko de caractères|`Mailbox.displayNewAppointmentForm` Méthode|Limite pour le corps dans un nouveau formulaire de rendez-vous.|
|Affichage du corps d’un élément existant|32 Ko de caractères|Méthode [mailbox.displayAppointmentForm](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)<br/><br/> Méthode [mailbox.displayMessageForm](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)|Pour Outlook sur le web et les appareils mobiles : limite pour le corps dans un formulaire de rendez-vous ou de message existant.|
|Définition du corps|1 Mo de caractères|Méthode [Body.prependAsync](/javascript/api/outlook/office.body#outlook-office-body-prependasync-member(1))<br/> <br/>[Body.setAsync](/javascript/api/outlook/office.body#outlook-office-body-setasync-member(1))<br/><br/>Méthode [Body.setSelectedDataAsync](/javascript/api/outlook/office.body#outlook-office-body-setselecteddataasync-member(1))|Limite pour la définition du corps d’un élément de rendez-vous ou de message.|
|Nombre de pièces jointes|499 fichiers sur Outlook sur le web et appareils mobiles|Méthode [item.addFileAttachmentAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)|Limite du nombre de fichiers pouvant être joints à un élément à envoyer. Outlook sur le web et les appareils mobiles limitent généralement l’attachement jusqu’à 499 fichiers, via l’interface utilisateur et `addFileAttachmentAsync`. Un client riche Outlook ne limite pas spécifiquement le nombre de pièces jointes. Toutefois, tous les clients Outlook respectent la limite de la taille des pièces jointes avec lesquelles le Exchange Server de l’utilisateur a été configuré. Reportez-vous à la ligne suivante pour connaître la taille des pièces jointes.|
|Taille des pièces jointes|En fonction du serveur Exchange Server|`item.addFileAttachmentAsync` Méthode|La taille de toutes les pièces jointes d’un élément est limitée ; l’administrateur peut définir cette limite sur le serveur Exchange Server de la boîte aux lettres de l’utilisateur.Pour un client riche Outlook, limite le nombre de pièces jointes d’un élément. Pour Outlook sur le web et les appareils mobiles, la moindre des deux limites ( le nombre de pièces jointes et la taille de toutes les pièces jointes ) limite les pièces jointes réelles d’un élément.|
|Nom de fichier des pièces jointes|255 caractères|`item.addFileAttachmentAsync` Méthode|Limite pour la longueur du nom de fichier d’une pièce jointe à ajouter à un élément.|
|URI des pièces jointes|2 048 caractères|`item.addFileAttachmentAsync` Méthode|Limite pour l’URI du nom de fichier à ajouter en tant que pièce jointe à un élément.|
|ID des pièces jointes|100 caractères|Méthode [item.addItemAttachmentAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)<br/><br/> Méthode [item.removeAttachmentAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)|Limite pour la longueur de l’ID de la pièce jointe à ajouter à un élément ou à supprimer d’un élément.|
|Appels asynchrones|3 appels|`item.addFileAttachmentAsync` Méthode<br/><br/>`item.addItemAttachmentAsync` Méthode<br/><br/><br/>`item.removeAttachmentAsync` Méthode<br/><br/> Méthode [Body.getTypeAsync](/javascript/api/outlook/office.body#outlook-office-body-gettypeasync-member(1))<br/><br/>`Body.prependAsync` Méthode<br/><br/>`Body.setSelectedDataAsync` Méthode<br/><br/> Méthode [CustomProperties.saveAsync](/javascript/api/outlook/office.customproperties#outlook-office-customproperties-saveasync-member(1))<br/><br/><br/> [Article. LoadCustomPropertiesAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods) , méthode<br/><br/><br/> Méthode [Location.getAsync](/javascript/api/outlook/office.location#outlook-office-location-getasync-member(1))<br/><br/>`Location.setAsync` Méthode<br/><br/> Méthode [mailbox.getCallbackTokenAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)<br/><br/> Méthode [mailbox.getUserIdentityTokenAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)<br/><br/> Méthode [mailbox.makeEwsRequestAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)<br/><br/>`Recipients.addAsync` Méthode<br/><br/> Méthode [Recipients.getAsync](/javascript/api/outlook/office.recipients#outlook-office-recipients-getasync-member(1))<br/><br/>`Recipients.setAsync` Méthode<br/><br/> Méthode [RoamingSettings.saveAsync](/javascript/api/outlook/office.roamingsettings#outlook-office-roamingsettings-saveasync-member(1))<br/><br/> Méthode [Subject.getAsync](/javascript/api/outlook/office.subject#outlook-office-subject-getasync-member(1))<br/><br/>`Subject.setAsync` Méthode<br/><br/> Méthode [Time.getAsync](/javascript/api/outlook/office.time#outlook-office-time-getasync-member(1))<br/><br/> Méthode [Time.setAsync](/javascript/api/outlook/office.time#outlook-office-time-setasync-member(1))|Pour Outlook sur le web ou les appareils mobiles : limite du nombre d’appels asynchrones simultanés à tout moment, car les navigateurs autorisent uniquement un nombre limité d’appels asynchrones aux serveurs. |

## <a name="see-also"></a>Voir aussi

- [Déployer et installer des compléments Outlook à des fins de test](testing-and-tips.md)
- [Confidentialité, autorisations et sécurité pour les compléments Outlook](../concepts/privacy-and-security.md)
